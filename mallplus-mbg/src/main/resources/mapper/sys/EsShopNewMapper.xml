<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mei.zhuang.dao.sys.EsShopNewMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.mei.zhuang.entity.sys.EsShopNew">
        <result column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="brand_id" property="brandId"/>
        <result column="type_id" property="typeId"/>
        <result column="app_id" property="appId"/>
        <result column="app_secret" property="appSecret"/>
        <result column="original_id" property="originalId"/>
        <result column="applet_thumb" property="appletThumb"/>
        <result column="status" property="status"/>
        <result column="create_date" property="createDate"/>
        <result column="create_time" property="createTime"/>
        <result column="create_by_id" property="createById"/>
        <result column="update_date" property="updateDate"/>
        <result column="update_time" property="updateTime"/>
        <result column="update_by_id" property="updateById"/>
        <result column="is_delete" property="isDelete"/>
        <result column="description" property="description"/>
        <result column="brand_name" property="brandName"/>
        <result column="shopping_threshold" property="shoppingThreshold"/>
        <result column="is_show_shop_cart" property="isShowshopCart"/>
        <result column="is_show_goods_sold_out" property="isShowGoodsSoldOut"/>
        <result column="is_show_goods_evaluate" property="isShowGoodsEvaluate"/>
    </resultMap>
    <resultMap id="shopItem" type="com.mei.zhuang.entity.sys.EsShopNew" extends="BaseResultMap">
        <association property="shopBrand" javaType="com.mei.zhuang.entity.goods.EsShopBrand"
                     resultMap="com.mei.zhuang.dao.sys.EsShopBrandMapper.BaseResultMap"/>
    </resultMap>

    <select id="selectShopListByParam" parameterType="com.mei.zhuang.vo.ShopParam" resultMap="shopItem">
        select * from es_shop_new shop
        left join es_shop_brand shopB on shop.brand_id = shopB."id"
        where 1 = 1
        <if test="isDelete != null">
            and shop.is_delete = #{isDelete}
        </if>
        <include refid="query_list_condition"/>
        <if test="isAsc == 0">
            order by shop.id desc
        </if>
        <if test="isAsc == 1">
            order by shop.id asc
        </if>

    </select>


    <!--<select id="selectById" resultMap="shopItem" parameterType="java.lang.Long">
         select * from es_shop_new shop
         left join es_shop_brand shopB on shop.brand_id = shopB."id"
         where shop.id = #{id}

    </select>-->

    <select id="selectShopCountByParam" resultType="java.lang.Integer" parameterType="com.mei.zhuang.vo.ShopParam">
        select count(*) from es_shop_new shop
        left join es_shop_brand shopB on shop.brand_id = shopB."id"
        where 1=1
        <if test="isDelete != null">
            and shop.is_delete = #{isDelete}
        </if>
        <include refid="query_list_condition"/>

    </select>


    <sql id="query_list_condition">
        <if test="typeId != null and typeId != -1">
            and shop.type_id = #{typeId}
        </if>
        <if test="keyWord != null and keyWord !=''.toString()">
            and (
            shop.name like concat('%',#{keyWord},'%') or
            shop.brand_name like concat('%',#{keyWord},'%')
            )
        </if>
    </sql>


</mapper>
